@using TodoSeUsa.Application.Features.Consignments.DTOs
@using TodoSeUsa.Application.Features.Consignments.Interfaces

@inject IConsignmentService _consignmentService;

@inject DialogService _dialogService;

<RadzenStack AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center" class="rz-mb-4">
    <RadzenText TextStyle="TextStyle.H6">
        ¿Estás seguro que deseas borrar la consignación con <b>ID: @ConsignmentDto.Id </b>
        de <b>@ConsignmentDto.ProviderFullName </b>
        y emitida el: <b>@ConsignmentDto.DateIssued.ToString("yyyy/MM/dd HH:mm")</b>?</RadzenText>
</RadzenStack>
<RadzenCard Variant="Variant.Outlined" Style="border-color: red;" class="d-flex align-content-center align-items-center rz-mb-4">
    <RadzenIcon Icon="warning" IconStyle="IconStyle.Danger" Style="font-size: 2rem" class="me-1"></RadzenIcon>
    <RadzenText TextStyle="TextStyle.H6" Style="color:red; margin: 0">Ésta operación no se puede revertir</RadzenText>
</RadzenCard>
<RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center" Gap="3rem" Wrap="FlexWrap.Wrap">
    <RadzenButton IsBusy="busy" Icon="delete" Text="Borrar" BusyText="Borrando..." ButtonStyle="ButtonStyle.Danger" Size="ButtonSize.Large" Click="@(async () => await Delete(ConsignmentDto.Id))" />
</RadzenStack>

@code
{
    [Parameter] public required ConsignmentDto ConsignmentDto { get; set; }

    bool busy;

    async Task Delete(int consignmentId)
    {
        busy = true;
        var result = await _consignmentService.DeleteByIdAsync(consignmentId, CancellationToken.None);
        busy = false;
        _dialogService.Close(result);
    }
}